early$link_delete(name = paste0("col_attrs/", "velocity_confidence_transition"))
early$link_delete(name = paste0("col_attrs/", "velocity_length"))
early$link_delete(name = paste0("col_attrs/", "velocity_pseudotime"))
early$link_delete(name = paste0("col_attrs/", "velocity_self_transition"))
early[['col_attrs']]
early
early[['layers']]
early[['row_attrs']]
print(early[['row_attrs']])
early[['row_attrs/Accenssion']]
early[['row_attrs/Accession']]
early$link_delete(name = paste0("row_attrs/", "Accession"))
early$link_delete(name = paste0("row_attrs/", "Chromosome"))
early$link_delete(name = paste0("row_attrs/", "End"))
early$link_delete(name = paste0("row_attrs/", "Start"))
early$link_delete(name = paste0("row_attrs/", "Strand"))
early$link_delete(name = paste0("row_attrs/", "log1p_mean_counts"))
early$link_delete(name = paste0("row_attrs/", "log1p_total_counts"))
early$link_delete(name = paste0("row_attrs/", "mean_counts"))
early$link_delete(name = paste0("row_attrs/", "n_cells"))
early[['row_attrs']]
early$link_delete(name = paste0("row_attrs/", "n_cells_by_counts"))
early$link_delete(name = paste0("row_attrs/", "pct_dropout_by_counts"))
early$link_delete(name = paste0("row_attrs/", "total_counts"))
early$link_delete(name = paste0("row_attrs/", "velocity_gamma"))
early$link_delete(name = paste0("row_attrs/", "velocity_genes"))
early$link_delete(name = paste0("row_attrs/", "velocity_r2"))
early[['row_attrs']]
early
early[['col_graphs']]
early[['row_graphs']]
early$close_all()
rm(early)
early<-connect(filename = '~/Desktop/LabThings/Epoch/Epoch/master/warpnet/data/NaiveToPrimed_DPT.loom', mode="r+",skip.validate=TRUE)
early
early[['col_attrs']]
early[['row_attrs']]
early[['layers']]
early$link_delete(name = paste0("layers/", "Ms"))
early$link_delete(name = paste0("layers/", "Mu"))
early$link_delete(name = paste0("layers/", "variance_velocity"))
early$link_delete(name = paste0("layers/", "velocity"))
early[['layers']]
early$close_all()
rm(early)
library(loomR)
early<-connect(filename = '~/Desktop/LabThings/Epoch/Epoch/master/warpnet/data/NaiveToPrimed_DPT.loom', mode="r+",skip.validate=TRUE)
early[['layers']]
early
early[['row_attrs']]
early[['col_attrs']]
x=list(a=c("a","b","c"),b=c("c","d","e"),c=c("1","2"))
y=list(a=c("f","g","h"),b=c("b","d","e"),c=c("3","2"))
x
y
list(x=x,y=y)
epochs<-list(x=x,y=y)
mapply(c,epochs)
sapply(mapply(c,),unique)
sapply(epochs,mapply(c,),unique)
sapply(mapply(c,epochs),unique)
sapply(mapply(c,),unique)
epochs
mapply(c,epochs)
c(mapply(c,epochs))
epochs
do.call(c,epochs)
do.call(mapply(c,),epochs)
do.call(map,epochs)
do.call(Map,epochs)
do.call(Map(),epochs)
do.call(c,epochs)
epochs
do.call(c,lapply,epochs)
vecs <- unlist(epochs, recursive = F)
lapply(unique(names(vecs)), function(name) do.call(c, vecs[name == names(vecs)]))
vecs
rm(vecs)
unlist(epochs)
unlist(epochs,recursive=F)
vecs <- unlist(epochs, recursive = F)
lapply(unique(names(vecs)), function(name) do.call(c, vecs[name == names(vecs)]))
names(vecs)
unique(names(vecs))
epochs
names(unlist(epochs,recursive=FALSE,use.names=FALSE))
names(unlist(epochs,recursive=FALSE))
unlist(epochs,recursive=FALSE,use.names=FALSE)
names(unlist(epochs,recursive=FALSE))
vecs <- unlist(epochs, recursive = F)
lapply(unique(names(vecs)), function(name) do.call(c, vecs[name == names(vecs)]))
vecs
unique(names(vecs))
vecs <- unlist(epochs, recursive = F)
lapply(unique(names(vecs)), function(name) do.call(c, vecs[name == names(vecs)]))
names(vecs)
vecs
sub('.*\\.', '', names(vecs))
vecs
names(vecs)<-sub('.*\\.', '', names(vecs))
vecs
lapply(unique(names(vecs)), function(name) do.call(c, vecs[name == names(vecs)]))
lapply(unique(names(vecs)), function(name) mapply(c, vecs[name == names(vecs)]))
vecs
lapply(unique(names(vecs)), function(name) lapply(c, vecs[name == names(vecs)]))
lapply(unique(names(vecs)), function(name) sapply(c, vecs[name == names(vecs)]))
lapply(unique(names(vecs)), function(name) mapply(c, vecs[name == names(vecs)]))
lapply(unique(names(vecs)), function(name) lapply(vecs[name == names(vecs)],c))
lapply(unique(names(vecs)), function(name) sapply(vecs[name == names(vecs)],c))
lapply(unique(names(vecs)), function(name) flatten(sapply(vecs[name == names(vecs)],c)))
lapply(unique(names(vecs)), function(name) unlist(sapply(vecs[name == names(vecs)],c)))
lapply(unique(names(vecs)), function(name) as.vector(sapply(vecs[name == names(vecs)],c)))
unique(names(vecs))
vecs <- unlist(epochs, recursive = F)
names(vecs)<-sub('.*\\.', '', names(vecs))
vecs2<-lapply(unique(names(vecs)), function(name) as.vector(sapply(vecs[name == names(vecs)],c)))
names(vecs2)<-unique(names(vecs))
vecs2<-lapply(vecs2,unique)
vvecs
vecs2
temp <- vector(mode = "list", length = length(names(vecs2[[1]])))
temp
temp <- vector(mode = "list", length = length(names(epochs[[1]])))
names(temp)<-names(epochs[[1]])
temp
for (e in names(epochs)){
temp<-Map(c,temp,epochs[[e]])
}
temp
epochs<-sapply(temp,unique)
epochs
library(dyngen)
install.packages("dyngen")
remove.packages("dyngen")
install.packages("dyngen")
library(tidyverse)
library(dyngen)
set.seed(1)
backbone <- backbone_bifurcating()
install.packages(tidyverse)
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
library(dyngen)
set.seed(1)
backbone <- backbone_bifurcating()
config <-
initialise_model(
backbone = backbone,
num_cells = 1000,
num_tfs = nrow(backbone$module_info),
num_targets = 250,
num_hks = 250,
simulation_params = simulation_default(
census_interval = 10,
ssa_algorithm = ssa_etl(tau = 300 / 3600),
experiment_params = simulation_type_wild_type(num_simulations = 100)
)
)
model_common <-
config %>%
generate_tf_network() %>%
generate_feature_network() %>%
generate_kinetics() %>%
generate_gold_standard()
model_wt <- model_common %>%
generate_cells()
plot_gold_mappings(model_wt, do_facet = FALSE)
b3_genes <- model_common$feature_info %>% filter(module_id == "B3") %>% pull(feature_id)
b3_genes
model_ko <- model_common
model_ko$simulation_params$experiment_params <- simulation_type_knockdown(
num_simulations = 100L,
timepoint = 0,
genes = b3_genes,
num_genes = length(b3_genes),
multiplier = 0
)
model_ko <- model_ko %>%
generate_cells()
plot_gold_mappings(model_ko, do_facet = FALSE)
load("~/Desktop/model_102519.rda")
model$simulation_system$reactions
model$simulation_system$reactions[1:10]
model$simulation_system$reactions[50:60]
sapply(model$simulation_system$reactions,function(x) x$name=="rxn"transcription_B1_TF1"")
sapply(model$simulation_system$reactions,function(x) x$name=="transcription_B1_TF1")
cond<-sapply(model$simulation_system$reactions,function(x) x$name=="transcription_B1_TF1")
model$simulation_system$reactions[50:60]
reg<-gsub("(.*);.*","\\1",model$simulation_system$reactions[cond][[1]]$propensity)
reg
model$simulation_system$reactions[cond][[1]]$propensity
library(epoch)
list12<-loadDataFromLoom()
list12<-loadDataFromLoom("~/Desktop/LabThings/Epoch/Epoch/master/warpnet/data/sampled_mesoderm_WAG.loom")
sampTab<-list12[['sampTab']]
head(sampTab)
library(epoch)
packageVersion("loomR")
library(loomR)
lfile <- connect(filename = '~/Desktop/LabThings/Epoch/20200121rescue_20101205_multiseq_reprocess20201020/20191205multiseq_scvelo_20201020.loom', skip.validate=TRUE)
col_attrs<-lfile[['col_attrs']]$names
lfile$get.attribute.df(attributes=col_attrs)
lfile$get.attribute.df(attributes=col_attrs,col.names='obs_names')
lfile$get.attribute.df(attribute.names=col_attrs,col.names='obs_names')
sampTab<-tryCatch({lfile$get.attribute.df(attributes = col_attrs, col.names='obs_names')},
error=function(e){
lfile$get.attribute.df(attribute.names = col_attrs, col.names='obs_names')
})
sampTab2<-tryCatch({lfile$get.attribute.df(attribute.names = col_attrs, col.names='obs_names')},
error=function(e){
lfile$get.attribute.df(attributes = col_attrs, col.names='obs_names')
})
head(sampTab2)
head(sampTab)
load("~/Desktop/LabThings/Epoch/20200121rescue_20101205_multiseq_reprocess20201020/analysis_112320/reconstruction_by_path_0zThresh/dynamicGRN_p1.rda")
load("~/Desktop/LabThings/Epoch/20200121rescue_20101205_multiseq_reprocess20201020/analysis_112320/reconstruction_by_path_0zThresh/staticGRN_p1_crossweight.rda")
head(p1grnDF)
grn<-p1grnDF[p1grnDF$weighted_score>2.5,]
grn<-p1grnDF[p1grnDF$weighted_score>3,]
head(grn)
grnDF[grnDF$TF=="Meox1",]
grn[grn$TF=="Meox1",]
p1grnDF[p1grnDF$TF=="meox1",]
p1grnDF[p1grnDF$TF=="Meox1",]
p1grnDF[p1grnDF$TF=="Meox1" & p1grnDF$weighted_score>1,]
load("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/20210817_mesoderm_comparision/in_vivo_on.rda")
lapply(in_vivo_on,function(x){x[x$TF=="Meox1",]})
lapply(in_vivo_on,function(x){x[x$TF=="Cited1",]})
lapply(p1dynamic_grn,function(x){x[x$TF=="Cited1",]})
lapply(p1dynamic_grn,function(x){x[x$TF=="Cited1" & x$weighted_score>2.5,]})
lapply(p1dynamic_grn,function(x){x[x$TF=="Cited1" & x$weighted_score>1.5,]})
lapply(in_vivo_on,function(x){x[x$TF=="Cited1",]})
load("~/Desktop/LabThings/Epoch/synthetic_data/analysis_050720_2/aupr_summary_050720_2.rda")
summary2<-summary
load("~/Desktop/LabThings/Epoch/synthetic_data/analysis_050720/aupr_summary_050720.rda")
summ<-rbind(summary,summary2)
toplot<-summ[summ$method %in% c("CLR_pearson","CLR_pearson_crossweight","CLR_MI","CLR_MI_crossweight","GENIE3","GENIE3_dyn","GENIE3_dyn_crossweight","Epoch_pearson","Epoch_pearson_crossweight","Epoch_MI","Epoch_MI_crossweight"),]
# re-name methods for the plot
toplot$method<-as.character(toplot$method)
toplot$method[toplot$method=="CLR_pearson"]<-"CLR_Pearson"
toplot$method[toplot$method=="CLR_pearson_crossweight"]<-"CLR_Pearson_crossweight"
toplot$method[toplot$method=="Epoch_pearson"]<-"Epoch_Pearson"
toplot$method[toplot$method=="Epoch_pearson_crossweight"]<-"Epoch_Pearson_crossweight"
toplot$method<-factor(toplot$method,levels=c("CLR_Pearson","CLR_Pearson_crossweight","CLR_MI","CLR_MI_crossweight","GENIE3","GENIE3_dyn","GENIE3_dyn_crossweight","Epoch_Pearson","Epoch_Pearson_crossweight","Epoch_MI","Epoch_MI_crossweight"))
toplot$base_method<-"CLR"
toplot$base_method[toplot$method %in% c("Epoch_Pearson","Epoch_Pearson_crossweight","Epoch_MI","Epoch_MI_crossweight")]<-"Epoch"
toplot$base_method[toplot$method %in% c("GENIE3","GENIE3_dyn","GENIE3_dyn_crossweight")]<-"GENIE3"
head(toplot)
toplot
aggregate(toplot,by=list(method),FUN=mean)
aggregate(toplot,by=list("method"),FUN=mean)
aggregate(toplot[,c('method','aupr_ratio')],by=list("method"),FUN=mean)
aggregate(toplot[,c('method','aupr_ratio')],by=list(method),FUN=mean)
aggregate(aupr_ratio~method,data=toplot,mean)
BiocManager::install("tradeSeq")
library(tradeSeq)
library(epoch)
library(tradeSeq)
invivo<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/adGrosswendt_trimmed250_raw_081621.loom")
rm(invivo)
raw<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/adGrosswendt_trimmed250_raw_081621.loom")
raw_exp<-raw[['expDat']]
raw_exp[1:5,1:5]
list12<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/adGrosswendt_trimmed250_dpt_20210817.loom")
expDat<-list12[['expDat']]
sampTab<-list12[['sampTab']]
expDat[1:5,1:5]
raw_exp<-raw_exp[,rownames(sampTab)]
raw_exp<-raw_exp[rownames(expDat),]
dim(raw_exp)
dim(sampTab)
sampTab_meso<-sampTab[sampTab$celltype %in% c("Epiblast","Primitive streak early","Primitive streak late","Mesoderm presomitic"),]
raw_exp<-raw_exp[,rownames(sampTab_meso)]
dim(raw_exp)
as.data.frame(sampTab_meso$dpt_pseudotime)
pt<-as.data.frame(sampTab_meso$dpt_pseudotime)
rownames(pt)<-rownames(sampTab_meso)
head(pt)
colnames(pt)<-"pseudotime"
head(pt)
ts<-fitGAM(as.matrix(raw_exp),pseudotime=as.matrix(pt))
as.matrix(rep(1,nrow(pt))
)
cw<-as.matrix(rep(1,nrow(pt)))
rownames(cw)<-rownames(sampTab_meso)
ts<-fitGAM(as.matrix(raw_exp),pseudotime=as.matrix(pt),cellWeights=cw)
ATres <- associationTest(ts)
head(ATres)
dgenes<-rownames(ATres)[ATres$pvalue<0.05]
length(dgenes)
load("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/20210817_mesoderm_comparision/mesoderm_sampled_xdyn.rda")
dgenes_epoch<-names(xdyn$genes)[xdyn$genes<0.05]
length(dgenes_epoch)
intersect(dgenes_epoch,dgenes)
length(intersect(dgenes_epoch,dgenes))
load("~/Desktop/LabThings/Epoch/mmTFs_123019.rda")
mmTFs <- setdiff(mmTFs, c("App", "Pcna"))
dtfs<-intersect(dgenes,mmTFs)
dtfs_epoch<-intersect(dgenes_epoch,mmTFs)
length(dtfs)
length(dtfs_epoch)
length(intersect(dtfs_epoch,dtfs))
ms <- loadDataFromLoom("~/Desktop/LabThings/Epoch/20200121rescue_20101205_multiseq_reprocess20201020/20191205multiseq_scvelo_20201020.loom")
exp_ms<-ms[['expDat']]
sampTab_ms<-ms[['sampTab']]
sampTab_ms<-sampTab_ms[sampTab_ms$leiden_refined %in% c("1","3","0","8"),]
exp_ms<-exp_ms[,rownames(sampTab_ms)]
raw<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20210825/adRaw_012720.loom")
exp_invitro_raw<-invitro[['expDat']]
exp_invitro_raw<-exp_invitro_raw[rownames(exp_ms),]
exp_invitro_raw<-exp_invitro_raw[,rownames(sampTab_ms)]
exp_invitro_raw<-raw[['expDat']]
exp_invitro_raw<-exp_invitro_raw[rownames(exp_ms),]
exp_invitro_raw<-exp_invitro_raw[,rownames(sampTab_ms)]
pt<-as.data.frame(sampTab_ms$latent_time)
rownames(pt)<-rownames(sampTab_ms)
colnames(pt)<-"pseudotime"
cw<-as.matrix(rep(1,nrow(pt)))
rownames(cw)<-rownames(sampTab_ms)
ts<-fitGAM(as.matrix(exp_invitro_raw),pseudotime=as.matrix(pt),cellWeights=cw)
ATres <- associationTest(ts)
dgenes_ms<-rownames(ATres)[ATres$pvalue<0.05]
length(dgenes_ms)
length(intersect(dgenes_ms,dgenes))
dtfs_ms<-intersect(dgenes_ms,mmTFs)
length(dtfs_ms)
length(intersect(dtfs_ms,dtfs))
x <- 5
load("~/Desktop/LabThings/DesLO/reference_data/GSE115469/HumanLiver.RData")
sCVdL
load("~/Desktop/LabThings/DesLO/reference_data/GSE115469/HumanLiver_savedRes.RData")
savedRes
install.packages('Seurat')
rm(list=ls())
load("~/Desktop/LabThings/DesLO/reference_data/GSE115469/HumanLiver.RData")
HumanLiverSeurat
HumanLiverSeurat$res.0.8
HumanLiverSeurat$total_counts
HumanLiverSeurat$orig.ident
HumanLiverSeurat@meta.data
head(HumanLiverSeurat@meta.data)
HumanLiverSeurat@assays
HumanLiverSeurat@meta.data$res.0.8
metadata<-HumanLiverSeurat@meta.data
write.table(metadata,file="~/Desktop/LabThings/DesLO/reference_data/GSE115469/GSE115469_metadata.csv",sep=",",quote=FALSE)
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e2c2.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e3c2.rda")
plot_e2c2<-lapply(enriched_e2c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
plot_e3c2<-lapply(enriched_e3c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df4<-plot_e2c2$GO_Biological_Process_2021
df6<-plot_e3c2$GO_Biological_Process_2021
df4$Term<-factor(df4$Term,levels=rev(df4$Term))
df6$Term<-factor(df6$Term,levels=rev(df6$Term))
g4<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vivo: epoch 2, community 2")
g6<-ggplot(df6,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vivo: epoch 3, community 2")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e2c4.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e3c1.rda")
enriched_e2c4<-lapply(enriched_e2c4,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
enriched_e3c1<-lapply(enriched_e3c1,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df2<-enriched_e2c4$GO_Biological_Process_2021[1:10,]
df4<-enriched_e3c1$GO_Biological_Process_2021[1:10,]
df2$Term<-factor(df2$Term,levels=rev(df2$Term))
df4$Term<-factor(df4$Term,levels=rev(df4$Term))
g9<-ggplot(df2,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vitro: epoch 2, community 4")
g10<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vitro: epoch 3, community 1")
library(ggplot2)
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e2c2.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e3c2.rda")
plot_e2c2<-lapply(enriched_e2c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
plot_e3c2<-lapply(enriched_e3c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df4<-plot_e2c2$GO_Biological_Process_2021
df6<-plot_e3c2$GO_Biological_Process_2021
df4$Term<-factor(df4$Term,levels=rev(df4$Term))
df6$Term<-factor(df6$Term,levels=rev(df6$Term))
g4<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vivo: epoch 2, community 2")
g6<-ggplot(df6,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vivo: epoch 3, community 2")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e2c4.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e3c1.rda")
enriched_e2c4<-lapply(enriched_e2c4,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
enriched_e3c1<-lapply(enriched_e3c1,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df2<-enriched_e2c4$GO_Biological_Process_2021[1:10,]
df4<-enriched_e3c1$GO_Biological_Process_2021[1:10,]
df2$Term<-factor(df2$Term,levels=rev(df2$Term))
df4$Term<-factor(df4$Term,levels=rev(df4$Term))
g9<-ggplot(df2,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vitro: epoch 2, community 4")
g10<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.75,hjust=0,size=2.5) + ggtitle("in vitro: epoch 3, community 1")
library(gridExtra)
grid.arrange(g4,g6,g9,g10,ncol=4)
grid.arrange(g4,g6,g9,g10,ncol=2)
g4<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 2, community 2")
g6<-ggplot(df6,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 3, community 2")
g9<-ggplot(df2,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 2, community 4")
g10<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=8)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 3, community 1")
grid.arrange(g4,g6,g9,g10,ncol=2)
g4<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 2, community 2")
g6<-ggplot(df6,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 3, community 2")
g9<-ggplot(df2,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 2, community 4")
g10<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 3, community 1")
library(gridExtra)
grid.arrange(g4,g6,g9,g10,ncol=2)
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e2c2.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e3c2.rda")
plot_e2c2<-lapply(enriched_e2c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
plot_e3c2<-lapply(enriched_e3c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df4<-plot_e2c2$GO_Biological_Process_2021
df6<-plot_e3c2$GO_Biological_Process_2021
df4$Term<-factor(df4$Term,levels=rev(df4$Term))
df6$Term<-factor(df6$Term,levels=rev(df6$Term))
g4<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 2, community 2")
g6<-ggplot(df6,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 3, community 2")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e2c4.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e3c1.rda")
enriched_e2c4<-lapply(enriched_e2c4,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
enriched_e3c1<-lapply(enriched_e3c1,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df2<-enriched_e2c4$GO_Biological_Process_2021[1:10,]
df3<-enriched_e3c1$GO_Biological_Process_2021[1:10,]
df2$Term<-factor(df2$Term,levels=rev(df2$Term))
df3$Term<-factor(df3$Term,levels=rev(df3$Term))
g9<-ggplot(df2,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 2, community 4")
g10<-ggplot(df3,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 3, community 1")
library(gridExtra)
library(ggplot2)
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e2c2.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e3c2.rda")
plot_e2c2<-lapply(enriched_e2c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
plot_e3c2<-lapply(enriched_e3c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df4<-plot_e2c2$GO_Biological_Process_2021
df6<-plot_e3c2$GO_Biological_Process_2021
df4$Term<-factor(df4$Term,levels=rev(df4$Term))
df6$Term<-factor(df6$Term,levels=rev(df6$Term))
g4<-ggplot(df4,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 2, community 2")
g6<-ggplot(df6,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vivo: epoch 3, community 2")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e2c4.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e3c1.rda")
enriched_e2c4<-lapply(enriched_e2c4,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
enriched_e3c1<-lapply(enriched_e3c1,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df2<-enriched_e2c4$GO_Biological_Process_2021[1:10,]
df3<-enriched_e3c1$GO_Biological_Process_2021[1:10,]
df2$Term<-factor(df2$Term,levels=rev(df2$Term))
df3$Term<-factor(df3$Term,levels=rev(df3$Term))
g9<-ggplot(df2,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 2, community 4")
g10<-ggplot(df3,aes(x=Term,y=Combined.Score))+geom_bar(stat='identity',width=.2)+coord_flip()+theme_classic()+theme(axis.text.y = element_blank(),axis.title.y=element_blank(),axis.title.x=element_text(size=8),plot.title=element_text(size=9)) + geom_text(aes(label=Term,y=0),vjust=1.5,hjust=0,size=3) + ggtitle("in vitro: epoch 3, community 1")
library(gridExtra)
grid.arrange(g4,g6,g9,g10,ncol=2)
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/communities_invivo_on_dthresh2-5_20211005.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/in_vivo_on_dthresh2-5_20211005.rda")
for (n in names(communities2)){
repressed<-in_vivo_on[[n]]$TG[in_vivo_on[[n]]$interaction=="repression"]
communities2[[n]]$communities[communities2[[n]]$gene %in% repressed]<-"r"
}
ms <- loadDataFromLoom("~/Desktop/LabThings/Epoch/20200121rescue_20101205_multiseq_reprocess20201020/20191205multiseq_scvelo_20201020.loom")
exp_ms<-ms[['expDat']]
sampTab_ms<-ms[['sampTab']]
sampTab_ms<-sampTab_ms[sampTab_ms$leiden_refined %in% c("1","3","0","8"),]
exp_ms<-exp_ms[,rownames(sampTab_ms)]
list12<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20210827/20191205multiseq_scvelo_20201020_full_normalized.loom")
expDat<-list12[['expDat']]
sampTab<-list12[['sampTab']]
sampTab<-sampTab[rownames(sampTab_ms),]
expDat<-expDat[,rownames(sampTab)]
invivo<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/adGrosswendt_trimmed250_dpt_20210817.loom")
expDat_invivo<-invivo[['expDat']]
sampTab_invivo<-invivo[['sampTab']]
sampTab_invivo<-sampTab_invivo[sampTab_invivo$celltype %in% c("Epiblast","Primitive streak early","Primitive streak late","Mesoderm presomitic"),]
expDat_invivo<-expDat_invivo[,rownames(sampTab_invivo)]
common_genes<-intersect(unique(dplyr::bind_rows(communities2)$gene),rownames(expDat))
communities_common<-lapply(communities2,function(x){x[x$gene %in% common_genes,]})
library(epoch)
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/communities_invivo_on_dthresh2-5_20211005.rda")
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/in_vivo_on_dthresh2-5_20211005.rda")
for (n in names(communities2)){
repressed<-in_vivo_on[[n]]$TG[in_vivo_on[[n]]$interaction=="repression"]
communities2[[n]]$communities[communities2[[n]]$gene %in% repressed]<-"r"
}
ms <- loadDataFromLoom("~/Desktop/LabThings/Epoch/20200121rescue_20101205_multiseq_reprocess20201020/20191205multiseq_scvelo_20201020.loom")
exp_ms<-ms[['expDat']]
sampTab_ms<-ms[['sampTab']]
sampTab_ms<-sampTab_ms[sampTab_ms$leiden_refined %in% c("1","3","0","8"),]
exp_ms<-exp_ms[,rownames(sampTab_ms)]
list12<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20210827/20191205multiseq_scvelo_20201020_full_normalized.loom")
expDat<-list12[['expDat']]
sampTab<-list12[['sampTab']]
sampTab<-sampTab[rownames(sampTab_ms),]
expDat<-expDat[,rownames(sampTab)]
invivo<-loadDataFromLoom("~/Desktop/LabThings/Epoch/invivo_comparison/Grosswendt/adGrosswendt_trimmed250_dpt_20210817.loom")
expDat_invivo<-invivo[['expDat']]
sampTab_invivo<-invivo[['sampTab']]
sampTab_invivo<-sampTab_invivo[sampTab_invivo$celltype %in% c("Epiblast","Primitive streak early","Primitive streak late","Mesoderm presomitic"),]
expDat_invivo<-expDat_invivo[,rownames(sampTab_invivo)]
common_genes<-intersect(unique(dplyr::bind_rows(communities2)$gene),rownames(expDat))
communities_common<-lapply(communities2,function(x){x[x$gene %in% common_genes,]})
communities_common$epoch2$gene[communities_common$epoch2$communities==2]
communities_common$epoch3$gene[communities_common$epoch3$communities==2]
communities_common$epoch3$gene[communities_common$epoch3$communities==1]
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e2c2.rda")
plot_e2c2<-lapply(enriched_e2c2,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df4<-plot_e2c2$GO_Biological_Process_2021
df4
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invivo_on/enriched_e3c1.rda")
df2<-enriched_e3c1$GO_Biological_Process_2021[1:10,]
plot_e3c1<-lapply(enriched_e3c1,function(x){x<-x[order(x$Combined.Score,decreasing=TRUE),];x[1:10,]})
df5<-plot_e3c1$GO_Biological_Process_2021
df5
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e1c2.rda")
enriched_e1c2
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e1c3.rda")
enriched_e1c3
load("~/Desktop/LabThings/Epoch/invivo_comparison/analysis_20211005/gsea_invitro_on/enriched_e1c4.rda")
enriched_e1c4
setwd("~/Desktop/LabThings/Epoch/Epoch/master/warpnet")
devtools::document()
